<div class="submenu_products">
  {%- if block.settings.title != blank -%}
  <div class="headings text-center">
    <h4 class="heading weight-{{ block.settings.title_weight }} size-{{ block.settings.title_size }} font-{{ block.settings.title_font }}" style="color:{{ block.settings.title_color }};margin-bottom:{{ block.settings.title_spacing }}px;">{{ block.settings.title }}</h4>
  </div>
  {%- endif -%}

  {%- if block.settings.collection != blank and collections[block.settings.collection] != blank -%}
    {%- assign is_container = false -%}
    {%- assign my_collection = collections[block.settings.collection] -%}
    {%- assign cat_id = block.settings.collection -%}
    {%- assign grid_num = block.settings.grid_num -%}
    {%- assign grid_row = block.settings.grid_row -%}
    {%- assign max_pages = block.settings.max_pages -%}
    {%- if my_collection != blank -%}
      {%- assign max_pages_collection = my_collection.all_products_count | divided_by: grid_num | divided_by: grid_row -%}
      {%- if max_pages_collection < max_pages -%}
        {%- assign max_pages = max_pages_collection -%}
      {%- endif -%}
    {%- endif -%}

    {%- if block.settings.shop_product_options -%}
      {%- assign shop_image_ratio = block.settings.shop_image_ratio -%}
      {%- assign shop_image_ratio_crop = block.settings.shop_image_ratio_crop -%}
      {%- assign shop_image_second = block.settings.shop_image_second -%}
      {%- assign shop_image_overlay = block.settings.shop_image_overlay -%}
      {%- assign shop_product_hover = block.settings.shop_product_hover -%}
      {%- assign shop_vendor_enable = block.settings.shop_vendor_enable -%}
      {%- assign shop_review_enable = block.settings.shop_review_enable -%}
      {%- assign shop_quickview_enable = block.settings.shop_quickview_enable -%}
      {%- assign shop_wishlist_enable = block.settings.shop_wishlist_enable -%}
      {%- assign shop_compare_enable = block.settings.shop_compare_enable -%}
    {%- endif -%}

    {%- include 'products-slider', section_id: block.id, heading: '', cat_id: cat_id, grid_num: grid_num, grid_row: grid_row, max_pages: max_pages, is_container: is_container, is_sub: true -%}
    {%- if block.settings.show_view_all -%}
    <div class="view_more text-center"><a href="{{ my_collection.url }}" class="btn btn-primary">{{ 'sections.products.view_more' | t }}&nbsp;&nbsp;<i class="ion ion-md-add"></i></a></div>
    {%- endif -%}
  {%- else -%}
    {%- include 'no-blocks' -%}
  {%- endif -%}
</div>